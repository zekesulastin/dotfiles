#!/usr/bin/env bash

bash_prompt() {
  PROMPT_COMMAND='printf "\033]0;%s>%s:%s\007" "${HOSTNAME%%.*}" "${USER}" "${PWD/#$HOME/~}"'

  local NONE="\[\e[0m\]"    # unsets color to term's fg color

  # regular colors
  local K="\[\e[0;30m\]" R="\[\e[0;31m\]" G="\[\e[0;32m\]" Y="\[\e[0;33m\]" \
        B="\[\e[0;34m\]" M="\[\e[0;35m\]" C="\[\e[0;36m\]" W="\[\e[0;37m\]"

  # emphasized (bolded) colors
  local EMK="\[\e[1;30m\]" EMR="\[\e[1;31m\]" EMG="\[\e[1;32m\]" EMY="\[\e[1;33m\]" \
        EMB="\[\e[1;34m\]" EMM="\[\e[1;35m\]" EMC="\[\e[1;36m\]" EMW="\[\e[1;37m\]"

  (( UID != 0 )) && local UC=$G PR="$" || local UC=$R PR="#"

  RET_VALUE='$((( RET )) && printf "|\[\e[1;31m\]$RET\[\e[0m\]")'

  # different color for remote hosts
  [[ $SSH_TTY ]] && local HC=$Y || local HC=$B

  # space goes inside the printf so its not there when there's no git branch
	PS1=" $EMK┌┤$HC\h$EMK>$UC\u$EMK$RET_VALUE\$(__git_ps1 '\[\e[1;30m\]|\[\e[0;35m\]%s\[\e[0m\]')$EMK|$C\w$EMK$UC\n $EMK└$PR$NONE "

  export PS4='+$BASH_SOURCE[$LINENO]: '
}

# show return val of last command
GIT_PS1_SHOWDIRTYSTATE=yes
bash_prompt
unset bash_prompt
